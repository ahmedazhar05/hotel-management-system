' Gambas class file


Public Sub back_Click()

  FMain.Load
  FMain.Show
  Me.Close()

End

Public Sub createEvent_Click()

  Dim ev As Collection = ["name": evName.Text]
  ev.Add(evDate.Text, "date")
  ev.Add(price.Text, "price")
  ev.Add(time.Text, "time")
  ev.Add(info.Text, "info")
  
  eventList.Add(evName.Text)
  
  Dim fl As File
  
  fl = Open User.Home & "/events.txt" For Append Watch
  Write #fl, ev["name"] & "\n"
  Write #fl, ev["date"] & "\n"
  Write #fl, ev["price"] & "\n"
  Write #fl, ev["time"] & "\n"
  Write #fl, ev["info"] & "\n"
  Close #fl

End

Public Sub details_Click()

  Dim ev As File
  Dim i As Integer = 0
  Dim k As Integer = 0
  Dim ln As String
  
  Dim lbls As String[] = ["Name : ", "Date : ", "Price : ", "Time :", "Info : "]
  Dim wids As Integer[] = [72, 120, 120, 80, 72]
  
  ev = Open User.Home & "/events.txt" For Read
  While Not Eof(ev)
    Line Input #ev, ln
    If ln = eventList.Text Then
      For i As Integer = 0 To 4
        
        Dim lb As Label
        lb = New Label(DetailForm)
        lb.Text = lbls[i]
        lb.X = 32
        lb.Y = (i + 1) * 8 + (i + 2) * 32 + k
        lb.W = wids[i]
        lb.H = 32
        
        
        Dim vl As TextBox
        vl = New TextBox(DetailForm)
        vl.Text = ln
        vl.X = wids[i] + 32 + 8
        vl.Y = (i + 1) * 8 + (i + 2) * 32 + k
        vl.W = 320 - (wids[i] + 32 + 8 + 32)
        vl.H = 32
        
        
        Line Input #ev, ln
      Next
    Endif
  Wend
  Close #ev
  
  Dim title As Label
  title = New Label(DetailForm)
  title.Text = "Event Detail"
  title.Name = "title"
  title.X = 32
  title.Y = 32
  title.H = 32
  title.W = 248
  title.Alignment = Align.Center
  title.Font = Font["Bold,+3"]
  
  Dim cl As Button
  cl = New Button(DetailForm) As "CloseBtn"
  cl.X = 152
  cl.Y = 288
  cl.W = 136
  cl.H = 32
  cl.Name = "close"
  cl.Text = "Close"
  
  DetailForm.W = 320
  DetailForm.H = 352
  DetailForm.Title = "Event Detail"
  DetailForm.Load(EventForm)
  DetailForm.Show()
  

End

Public Sub CloseBtn_click()
  
  DetailForm.Close()
  
End

Public Sub Form_Open()
  
  Dim ev As File
  Dim i As Integer = 0
  Dim ln As String
  
  ev = Open User.Home & "/events.txt" For Read
  
  While Not Eof(ev)
    Line Input #ev, ln
    If i % 5 = 0 Then
      eventList.Add(ln)
    Endif
    i = i + 1
  Wend
  Close #ev
  
End

Public Sub delete_Click()

  Dim ev As File
  Dim ln As String
  Dim i As Integer = 0
  Dim newfile As String
  
  ev = Open User.Home & "/events.txt" For Read Watch
  
  While Not Eof(ev)
    Line Input #ev, ln
    If (ln = eventList.Text) Or (i > 0 And i < 5) Then
      i = i + 1
    Else
      newfile &= ln & "\n"
    Endif
  Wend
  Close #ev

  ev = Open User.Home & "/events.txt" For Create Watch
  Write #ev, newfile
  
  eventList.Remove(eventList.Index)

End
